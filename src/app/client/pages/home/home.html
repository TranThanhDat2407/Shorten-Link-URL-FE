<div class="container text-center py-5 mb-4 ">
  <div class="p-5 mb-4 lc-block">

    <!-- Tiêu đề -->
    <div class="lc-block mb-4">
      <div>
        <h2 class="fw-bold display-2">LONG LINKS?</h2>
        <h2 class="fw-bold display-2">NOT ANYMORE.<br></h2>
      </div>
    </div>

    <div class="lc-block mb-5">
      <div>
        <p class="lead">Turn complex URLs into short, <strong>beautiful links</strong> and <strong>QR Code</strong>.<br>Share everything easier, instantly.</p>
      </div>
    </div>

    <!-- Form nhập link -->
    <div class="lc-block mb-4">
      <form (ngSubmit)="shorten()" #shortenForm="ngForm" class="input-group input-group-lg">
        <input
          type="url"
          class="form-control"
          placeholder="Paste your long link here..."
          aria-label="Long URL Input"
          [(ngModel)]="longUrl"
          name="longUrl"
          required
          #longUrlInput="ngModel"
          [class.is-invalid]="longUrlInput.invalid && longUrlInput.touched"
          [pattern]="URL_REGEX"
        >
        <button
          class="btn btn-primary"
          type="submit"
          [disabled]="longUrlInput.invalid || isCreating" >
          <span *ngIf="!isCreating">SHORTEN</span>
          <span *ngIf="isCreating">
        <span class="spinner-border spinner-border-sm me-2"></span>
        Creating...
      </span>
        </button>
      </form>

      <!-- Checkbox tạo QR -->
      <div class="text-start mt-3">
        <div class="form-check">
          <input
            class="form-check-input"
            type="checkbox"
            id="generateQrCode"
            [(ngModel)]="generateQrCode"
            name="generateQrCode"
            [ngModelOptions]="{standalone: true}"
          >
          <label class="form-check-label text-muted" for="generateQrCode">
            Generate QR Code
          </label>
        </div>
      </div>

      <div class="text-start mt-2">
        <small class="text-danger" *ngIf="longUrlInput.invalid && longUrlInput.touched">
      <span *ngIf="longUrlInput.errors?.['required']">
        The URL field is required.
      </span>
          <span *ngIf="longUrlInput.errors?.['pattern']">
        Please enter a valid URL format (e.g., google.com or https://google.com).
      </span>
        </small>
      </div>
    </div>

    <!-- Kết quả rút gọn (ẩn mặc định, hiện khi có result) -->
    <div class="lc-block mt-5" *ngIf="result">
      <div class="card shadow-lg border-0 bg-white p-4 p-md-5">

        <div class="text-center mb-4">
          <h3 class="fw-bolder text-success mb-1">
            Link Successfully Shortened!
          </h3>
        </div>

        <div class="mb-4">
          <label class="form-label small fw-bold text-dark">Your Short Link (Ready to use):</label>

          <div class="input-group input-group-lg shadow-sm">
            <input
              type="text"
              class="form-control text-primary fw-bolder border-0 bg-light"
              [value]="result.shortUrl"
              readonly
              #shortLinkInput
            >
            <button
              class="btn btn-primary fw-bold px-4"
              type="button"
              (click)="copyToClipboard(shortLinkInput.value)"
              title="Copy to clipboard"
            >
              Copy
            </button>
          </div>
        </div>

        <!-- QR Code -->
        <div class="text-center mt-4 pt-3 border-top" *ngIf="result.qrCodeUrl">
          <p class="mb-3 text-muted fw-bold">Scan this QR Code to access your link instantly</p>

          <div class="d-inline-block p-3 border rounded bg-white shadow-lg">
            <img
              [src]="result.qrCodeUrl"
              alt="QR Code"
              class="img-fluid"
              style="width: 180px; height: 180px;"
              id="qrCodeImage"
            >
          </div>

          <div class="mt-3">
            <button class="btn btn-sm btn-outline-secondary" type="button" (click)="downloadQR()">
              Download QR Code
            </button>
          </div>
        </div>

      </div>
    </div>

    <!-- Thông báo lỗi (nếu có) -->
    <div class="mt-4" *ngIf="error">
      <div class="alert alert-danger">
        {{ error }}
      </div>
    </div>

  </div>
</div>
